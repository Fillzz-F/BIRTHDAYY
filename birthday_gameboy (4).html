<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birthday Gift</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(45deg, #1a1a2e, #16213e, #0f3460);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .screen {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .screen.active { display: block; }

        /* Loading Screen */
        .loading-box {
            width: 600px;
            background: #000;
            border: 4px solid #00ff00;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
        }

        .loading-title {
            font-size: 48px;
            color: #00ff00;
            margin-bottom: 40px;
            animation: glow 2s infinite;
        }

        @keyframes glow {
            0%, 100% { text-shadow: 0 0 10px #00ff00; }
            50% { text-shadow: 0 0 30px #00ff00; }
        }

        .loading-text {
            color: #00ff00;
            font-size: 20px;
            margin-bottom: 30px;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #333;
            border: 2px solid #00ff00;
            border-radius: 5px;
            position: relative;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #00ff00;
            width: 0%;
            transition: width 0.3s;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #000;
            font-weight: bold;
        }

        /* Gameboy */
        .gameboy {
            width: 400px;
            background: linear-gradient(145deg, #e8e8e8, #d0d0d0);
            border-radius: 20px 20px 40px 40px;
            padding: 20px;
            box-shadow: 
                0 20px 40px rgba(0,0,0,0.4),
                inset 0 2px 4px rgba(255,255,255,0.8),
                inset 0 -2px 4px rgba(0,0,0,0.1);
            position: relative;
        }

        .gameboy::before {
            content: '';
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            height: 40%;
            background: linear-gradient(180deg, rgba(255,255,255,0.1), transparent);
            border-radius: 20px 20px 0 0;
            pointer-events: none;
        }

        .gb-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: 12px;
            color: #666;
        }

        .power-dot {
            width: 8px;
            height: 8px;
            background: #ff4444;
            border-radius: 50%;
            display: inline-block;
            margin-right: 5px;
        }

        .gb-screen {
            width: 100%;
            height: 200px;
            background: #2d5016;
            border: 8px solid #1a1a1a;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            box-shadow: 
                inset 0 0 20px rgba(0,0,0,0.6),
                inset 0 4px 8px rgba(0,0,0,0.5),
                0 2px 4px rgba(0,0,0,0.3);
            position: relative;
        }

        .gb-screen::before {
            content: '';
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            height: 30%;
            background: linear-gradient(180deg, rgba(155,188,15,0.05), transparent);
            border-radius: 4px;
            pointer-events: none;
        }

        .gb-screen h1 {
            color: #9bbc0f;
            font-size: 24px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .gb-screen p {
            color: #ffff00;
            font-size: 14px;
            margin-top: 10px;
        }

        .menu-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: auto auto;
            gap: 10px;
            margin-bottom: 30px;
        }

        .btn-tetris {
            grid-column: 1 / 3;
            justify-self: center;
            width: 60%;
        }

        .menu-btn {
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-family: inherit;
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: white;
            box-shadow: 
                0 4px 8px rgba(0,0,0,0.3),
                inset 0 2px 4px rgba(255,255,255,0.2),
                inset 0 -2px 4px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
        }

        .menu-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            filter: grayscale(70%);
            pointer-events: none;
        }

        .menu-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .menu-btn:not(:disabled):hover::before {
            left: 100%;
        }

        .menu-btn:not(:disabled):hover {
            transform: translateY(-3px);
            box-shadow: 
                0 6px 12px rgba(0,0,0,0.4),
                inset 0 2px 4px rgba(255,255,255,0.3),
                inset 0 -2px 4px rgba(0,0,0,0.2);
        }

        .menu-btn:not(:disabled):active {
            transform: translateY(-1px);
            box-shadow: 
                0 2px 4px rgba(0,0,0,0.3),
                inset 0 3px 6px rgba(0,0,0,0.4);
        }

        .btn-message { background: linear-gradient(145deg, #4a90e2, #357abd); }
        .btn-gallery { background: linear-gradient(145deg, #e74c3c, #c0392b); }
        .btn-tetris { background: linear-gradient(145deg, #27ae60, #229954); }

        .controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .dpad {
            width: 80px;
            height: 80px;
            position: relative;
            background: #333;
            border-radius: 50%;
            box-shadow: 
                0 4px 8px rgba(0,0,0,0.3),
                inset 0 -2px 4px rgba(0,0,0,0.5),
                inset 0 2px 4px rgba(255,255,255,0.1);
        }

        .dpad-center {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .dpad-center div {
            position: absolute;
            background: linear-gradient(145deg, #555, #444);
            color: #999;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 16px;
            box-shadow: 
                0 2px 4px rgba(0,0,0,0.3),
                inset 0 1px 2px rgba(255,255,255,0.2);
            pointer-events: none;
        }

        .dpad-up, .dpad-down {
            width: 30px;
            height: 25px;
            left: 50%;
            transform: translateX(-50%);
        }

        .dpad-up {
            top: 0;
            border-radius: 8px 8px 0 0;
        }

        .dpad-down {
            bottom: 0;
            border-radius: 0 0 8px 8px;
        }

        .dpad-left, .dpad-right {
            width: 25px;
            height: 30px;
            top: 50%;
            transform: translateY(-50%);
        }

        .dpad-left {
            left: 0;
            border-radius: 8px 0 0 8px;
        }

        .dpad-right {
            right: 0;
            border-radius: 0 8px 8px 0;
        }

        .action-btns {
            display: flex;
            gap: 15px;
        }

        .action-btn {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 50%;
            background: linear-gradient(145deg, #e74c3c, #c0392b);
            color: white;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.15s ease;
            box-shadow: 
                0 4px 8px rgba(0,0,0,0.3),
                inset 0 2px 4px rgba(255,255,255,0.3),
                inset 0 -2px 4px rgba(0,0,0,0.3);
            position: relative;
        }

        .action-btn:hover {
            background: linear-gradient(145deg, #e95e4f, #d44638);
            transform: translateY(-2px);
            box-shadow: 
                0 6px 12px rgba(0,0,0,0.4),
                inset 0 2px 4px rgba(255,255,255,0.3),
                inset 0 -2px 4px rgba(0,0,0,0.3);
        }

        .action-btn:active {
            background: linear-gradient(145deg, #c0392b, #a93226);
            transform: translateY(0);
            box-shadow: 
                0 2px 4px rgba(0,0,0,0.3),
                inset 0 3px 6px rgba(0,0,0,0.5);
        }

        .action-btn::after {
            content: '';
            position: absolute;
            top: 8px;
            left: 8px;
            right: 8px;
            height: 10px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            pointer-events: none;
        }

        .bottom-btns {
            display: flex;
            justify-content: center;
            gap: 30px;
        }

        .ctrl-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            background: linear-gradient(145deg, #777, #555);
            color: #ddd;
            font-family: inherit;
            font-size: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.15s ease;
            box-shadow: 
                0 3px 6px rgba(0,0,0,0.3),
                inset 0 1px 2px rgba(255,255,255,0.2);
        }

        .ctrl-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            pointer-events: none;
        }

        .ctrl-btn:not(:disabled):hover {
            background: linear-gradient(145deg, #888, #666);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.4);
        }

        .ctrl-btn:not(:disabled):active {
            background: linear-gradient(145deg, #555, #444);
            transform: translateY(0);
            box-shadow: 
                0 1px 3px rgba(0,0,0,0.3),
                inset 0 2px 4px rgba(0,0,0,0.5);
        }

        /* Page Container */
        .page-box {
            width: 400px;
            background: linear-gradient(145deg, #7b68ee, #6a5acd);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            border: 4px solid #ffd700;
        }

        .page-display {
            width: 100%;
            height: 480px;
            background: #2d5016;
            border: 4px solid #1a1a1a;
            border-radius: 8px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .page-title {
            background: #1a1a1a;
            color: #9bbc0f;
            padding: 10px;
            text-align: center;
            font-weight: bold;
        }

        .page-content {
            padding: 15px;
            color: #9bbc0f;
            height: calc(100% - 40px);
            overflow-y: auto;
        }

        .page-btns {
            display: flex;
            gap: 10px;
        }

        .page-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-family: inherit;
            font-weight: bold;
            cursor: pointer;
            background: #4a90e2;
            color: white;
        }

        .page-btn:hover { transform: translateY(-2px); }

        /* Message */
        #message-text {
            font-size: 14px;
            line-height: 1.8;
        }

        .skip-btn {
            display: block;
            margin: 10px auto;
            padding: 6px 12px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 10px;
            font-weight: bold;
        }

        /* Gallery */
        .gallery-content {
            padding: 15px;
            height: calc(100% - 60px);
            display: flex;
            flex-direction: column;
        }

        .photobox-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #666;
            padding: 8px 12px;
            border-radius: 4px;
            margin-bottom: 10px;
            flex-shrink: 0;
        }

        .photobox-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .photobox-dot.red { background: #ff4444; }
        .photobox-dot.green { background: #44ff44; }

        .photobox-title {
            color: #ffff00;
            font-size: 12px;
            font-weight: bold;
        }

        .photobox-progress {
            background: #333;
            border-radius: 4px;
            margin-bottom: 15px;
            padding: 8px;
            color: #9bbc0f;
            font-size: 11px;
            text-align: center;
            min-height: 20px;
            flex-shrink: 0;
        }

        .photo-display {
            background: #1a1a2e;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            margin-bottom: 15px;
            padding: 15px;
            overflow-y: auto;
            overflow-x: hidden;
            flex: 1;
            max-height: 300px;
        }

        .photo-display::-webkit-scrollbar { width: 6px; }
        .photo-display::-webkit-scrollbar-track { background: #333; border-radius: 3px; }
        .photo-display::-webkit-scrollbar-thumb { background: #9bbc0f; border-radius: 3px; }

        .photo-placeholder {
            text-align: center;
            color: #9bbc0f;
            font-size: 12px;
            margin-top: 50px;
        }

        .photo-strip {
            display: flex;
            flex-direction: column;
            width: 100%;
            max-width: 320px;
            background: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            min-height: 100%;
            position: relative;
            overflow: hidden;
        }

        .photo-strip-header {
            text-align: center;
            color: #333;
            font-size: 12px;
            font-weight: bold;
            padding: 15px 10px 10px 10px;
            border-bottom: 2px solid #ccc;
            background: #ffffff;
            flex-shrink: 0;
            position: relative;
            z-index: 2;
        }

        .photo-frames-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            overflow-x: hidden;
            max-height: 220px;
        }

        .photo-frames-container::-webkit-scrollbar { width: 5px; }
        .photo-frames-container::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 3px; }
        .photo-frames-container::-webkit-scrollbar-thumb { background: #c1c1c1; border-radius: 3px; }

        .photo-frame {
            width: 100%;
            height: 150px;
            background: #f0f0f0;
            border: 3px solid #333;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .photo-frame.filled {
            background: none;
            color: white;
            transform: scale(1.02);
            box-shadow: 0 3px 6px rgba(0,0,0,0.2);
        }

        .photo-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 3px;
            transition: opacity 0.3s ease;
        }

        .photo-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0,0,0,0.9));
            padding: 10px 6px 6px 6px;
            border-radius: 0 0 3px 3px;
        }

        .photo-content {
            color: #333;
            font-size: 11px;
            text-align: center;
            padding: 5px;
            font-weight: bold;
            line-height: 1.2;
        }

        .photo-frame.filled .photo-overlay .photo-content {
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            font-size: 10px;
            text-align: center;
            font-weight: bold;
            line-height: 1.2;
        }

        .photo-strip-footer {
            text-align: center;
            color: #666;
            font-size: 10px;
            font-weight: bold;
            background: #ffffff;
            padding: 8px;
            border-top: 2px solid #ccc;
            flex-shrink: 0;
            position: relative;
            z-index: 1;
        }

        .photobox-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: auto;
            padding-top: 10px;
            flex-shrink: 0;
        }

        .photo-btn {
            padding: 10px 20px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-family: inherit;
            font-size: 12px;
            font-weight: bold;
            transition: all 0.2s ease;
        }

        .photo-btn:hover {
            background: #c0392b;
            transform: scale(1.05);
        }

        .photo-btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }

        /* Tetris */
        #tetris-screen .page-display {
            display: flex;
            flex-direction: column;
        }

        .tetris-header {
            background: #1a1a1a;
            color: #9bbc0f;
            padding: 8px 15px;
            display: flex;
            justify-content: space-between;
            font-size: 12px;
        }

        .tetris-game {
            background: #2d5016;
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px;
        }

        #tetris-canvas {
            border: 2px solid #9bbc0f;
            border-radius: 4px;
            background: #0f0f0f;
        }

        .tetris-controls {
            display: flex;
            gap: 8px;
            justify-content: center;
            padding: 8px;
            background: #1a1a1a;
        }

        .tetris-btn {
            padding: 8px 16px;
            background: #4a90e2;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active { display: flex; }

        .modal-content {
            background: #2d5016;
            border: 4px solid #ffff00;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            max-width: 400px;
        }

        .game-over-text {
            color: #ff4444;
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .final-title {
            color: #ffff00;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .final-text {
            color: #9bbc0f;
            font-size: 16px;
            line-height: 1.8;
            margin-bottom: 20px;
        }

        .love-text {
            color: #ff69b4;
            font-weight: bold;
            font-size: 18px;
        }

        .modal-btn {
            padding: 12px 24px;
            background: #4a90e2;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }

        @media (max-width: 480px) {
            .gameboy, .page-box, .loading-box {
                width: 90vw;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="screen active">
        <div class="loading-box">
            <h1 class="loading-title">BIRTHDAY GIFT</h1>
            <div class="loading-text">&gt; INITIALIZING..._</div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
                <div class="progress-text">0%</div>
            </div>
        </div>
    </div>

    <!-- Main Screen -->
    <div id="main-screen" class="screen">
        <div class="gameboy">
            <div class="gb-header">
                <div>
                    <span class="power-dot"></span>
                    <span>POWER</span>
                </div>
                <div><strong>GAME-BOY</strong></div>
            </div>
            
            <div class="gb-screen">
                <div>
                    <h1>Happy Birthday!</h1>
                    <p>Press Start Button</p>
                </div>
            </div>

            <div class="menu-grid">
                <button class="menu-btn btn-message" onclick="showScreen('message')">MESSAGE</button>
                <button class="menu-btn btn-gallery" onclick="showScreen('gallery')">GALLERY</button>
                <button class="menu-btn btn-tetris" onclick="showScreen('tetris')">TETRIS</button>
            </div>

            <div class="controls">
                <div class="dpad">
                    <div class="dpad-center">
                        <div class="dpad-up">‚Üë</div>
                        <div class="dpad-left">‚Üê</div>
                        <div class="dpad-right">‚Üí</div>
                        <div class="dpad-down">‚Üì</div>
                    </div>
                </div>
                <div class="action-btns">
                    <button class="action-btn">B</button>
                    <button class="action-btn">A</button>
                </div>
            </div>

            <div class="bottom-btns">
                <button class="ctrl-btn">SELECT</button>
                <button class="ctrl-btn" onclick="showScreen('message')">START</button>
            </div>
        </div>
    </div>

    <!-- Message Screen -->
    <div id="message-screen" class="screen">
        <div class="page-box">
            <div class="page-display">
                <div class="page-title">Message</div>
                <div class="page-content" id="message-text"></div>
                <button class="skip-btn" onclick="skipTypewriter()">SKIP</button>
            </div>
            <div class="page-btns">
                <button class="page-btn" onclick="showScreen('main')">KEMBALI</button>
                <button class="page-btn" onclick="showScreen('gallery')">SELANJUTNYA</button>
            </div>
        </div>
    </div>

    <!-- Gallery Screen -->
    <div id="gallery-screen" class="screen">
        <div class="page-box">
            <div class="page-display">
                <div class="page-title">Gallery</div>
                <div class="gallery-content" id="gallery-content">
                    <!-- Content will be populated by JavaScript -->
                </div>
            </div>
            <div class="page-btns">
                <button class="page-btn" onclick="showScreen('main')">KEMBALI</button>
                <button class="page-btn" onclick="showScreen('tetris')">SELANJUTNYA</button>
            </div>
        </div>
    </div>

    <!-- Tetris Screen -->
    <div id="tetris-screen" class="screen">
        <div class="page-box">
            <div class="page-display">
                <div class="tetris-header">
                    <div><strong>TETRIS</strong></div>
                    <div>Score: <span id="score">0</span> | Level: <span id="level">1</span></div>
                </div>
                <div class="tetris-game">
                    <canvas id="tetris-canvas" width="330" height="360"></canvas>
                </div>
                <div class="tetris-controls">
                    <button class="tetris-btn" onclick="movePiece('left')">‚óÄ</button>
                    <button class="tetris-btn" onclick="rotatePiece()">ROTATE</button>
                    <button class="tetris-btn" onclick="movePiece('right')">‚ñ∂</button>
                </div>
            </div>
            <div class="page-btns">
                <button class="page-btn" onclick="showScreen('main')">KEMBALI</button>
            </div>
        </div>
    </div>

    <!-- Game Over Modal -->
    <div id="game-over-modal" class="modal">
        <div class="modal-content">
            <div class="game-over-text">GAME OVER</div>
            <button class="modal-btn" onclick="showFinalMessage()">CONFIRM</button>
        </div>
    </div>

    <!-- Final Message Modal -->
    <div id="final-message-modal" class="modal">
        <div class="modal-content">
            <div class="final-title">INGET YA!</div>
            <div class="final-text">
                <p>walaupun kamu kalah,</p>
                <p>tapi kamu selalu menang</p>
                <p>kok di hati aku, HEHE</p>
                <p>^_^</p>
                <p class="love-text">I LOVE YOU &lt;3</p>
            </div>
            <button class="modal-btn" onclick="closeFinalMessage()">OK</button>
        </div>
    </div>

    <script>
        let currentScreen = 'loading';
        let typeInterval = null;
        let tetrisGame = null;
        let score = 0;
        let level = 1;
        let bgMusic = null;
        let hasStarted = false;

        // Initialize background music
        function initMusic() {
            bgMusic = new Audio('your-music-file.mp3'); // Replace with your music file path
            bgMusic.loop = true;
            bgMusic.volume = 0.3; // 30% volume
        }

        function playMusic() {
            if (bgMusic) {
                bgMusic.play().catch(e => console.log('Music autoplay blocked'));
            }
        }

        function stopMusic() {
            if (bgMusic) {
                bgMusic.pause();
                bgMusic.currentTime = 0;
            }
        }

        // Enable menu after START is pressed
        function enableMenu() {
            hasStarted = true;
            document.getElementById('message-btn').disabled = false;
            document.getElementById('gallery-btn').disabled = false;
            document.getElementById('tetris-btn').disabled = false;
            
            // Remove arrow indicator
            const arrow = document.getElementById('arrow-indicator');
            if (arrow) {
                arrow.style.animation = 'fadeOut 0.5s forwards';
                setTimeout(() => arrow.remove(), 500);
            }
            
            // Add click handlers
            document.getElementById('message-btn').onclick = () => showScreen('message');
            document.getElementById('gallery-btn').onclick = () => showScreen('gallery');
            document.getElementById('tetris-btn').onclick = () => showScreen('tetris');
        }

        // Loading Animation
        window.addEventListener('load', () => {
            initMusic();
            const fill = document.getElementById('progress-fill');
            const text = document.querySelector('.progress-text');
            const msg = document.querySelector('.loading-text');
            
            let progress = 0;
            const messages = [
                '&gt; INITIALIZING..._',
                '&gt; LOADING MEMORIES..._',
                '&gt; PREPARING SURPRISE..._',
                '&gt; COMPLETE!_'
            ];
            
            const timer = setInterval(() => {
                progress += Math.random() * 20 + 5;
                if (progress > 100) progress = 100;
                
                fill.style.width = progress + '%';
                text.textContent = Math.floor(progress) + '%';
                
                const idx = Math.floor((progress / 100) * (messages.length - 1));
                msg.innerHTML = messages[idx];
                
                if (progress >= 100) {
                    clearInterval(timer);
                    setTimeout(() => {
                        showScreen('main');
                        playMusic(); // Start music after loading
                        
                        // Add START button listener
                        const startBtn = document.getElementById('start-btn');
                        if (startBtn) {
                            startBtn.onclick = () => {
                                if (!hasStarted) {
                                    enableMenu();
                                    showScreen('message');
                                }
                            };
                        }
                    }, 1000);
                }
            }, 200);
        });

        // Screen Navigation
        function showScreen(name) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(name + '-screen').classList.add('active');
            currentScreen = name;
            
            if (name === 'message') setTimeout(startTypewriter, 100);
            if (name === 'gallery') setTimeout(initGallery, 100);
            if (name === 'tetris') setTimeout(startTetris, 100);
        }

        // Gallery Functions
        let currentPhotoIndex = 0;

        function initGallery() {
            const galleryContent = document.getElementById('gallery-content');
            if (!galleryContent) return;
            
            galleryContent.innerHTML = `
                <div class="photobox-header">
                    <div class="photobox-dot red"></div>
                    <span class="photobox-title">PHOTOBOX</span>
                    <div class="photobox-dot green"></div>
                </div>
                <div class="photobox-progress">READY TO PRINT</div>
                <div class="photo-display">
                    <div class="photo-placeholder">Press MULAI CETAK to start photo session</div>
                </div>
                <div class="photobox-controls">
                    <button class="photo-btn" onclick="startPhotoShow()">MULAI CETAK</button>
                </div>
            `;
        }

        function startPhotoShow() {
            const photoBtn = document.querySelector('.photo-btn');
            const photoDisplay = document.querySelector('.photo-display');
            const progressDiv = document.querySelector('.photobox-progress');
            
            if (!photoBtn || !photoDisplay || !progressDiv) return;
            
            const photos = [
                { text: 'Our First Date üíï', image: './images/photo1.jpg' },
                { text: 'Birthday Moment üéÇ', image: './images/photo2.jpg' },
                { text: 'Adventure Time üåü', image: './images/photo3.jpg' },
                { text: 'Cozy Together ‚ù§Ô∏è', image: './images/photo4.jpg' },
                { text: 'Sweet Memories ü•∞', image: './images/photo5.jpg' },
                { text: 'Laugh Together üòÇ', image: './images/photo6.jpg' },
                { text: 'Perfect Day ‚òÄÔ∏è', image: './images/photo7.jpg' },
                { text: 'Love Forever üíñ', image: './images/photo8.jpg' }
            ];
            
            photoBtn.textContent = 'MENCETAK...';
            photoBtn.disabled = true;
            progressDiv.textContent = 'INITIALIZING CAMERA...';
            
            let framesHTML = '';
            for (let i = 0; i < photos.length; i++) {
                framesHTML += `<div class="photo-frame" id="frame-${i + 1}"><div class="photo-content">READY</div></div>`;
            }
            
            const photoStripHTML = `
                <div class="photo-strip">
                    <div class="photo-strip-header">PHOTOSTRIP SESSION</div>
                    <div class="photo-frames-container">${framesHTML}</div>
                    <div class="photo-strip-footer">üíï BIRTHDAY MEMORIES üíï</div>
                </div>
            `;
            
            photoDisplay.innerHTML = photoStripHTML;
            currentPhotoIndex = 0;
            
            let countdown = 3;
            progressDiv.textContent = `GET READY... ${countdown}`;
            
            const countdownInterval = setInterval(() => {
                countdown--;
                if (countdown > 0) {
                    progressDiv.textContent = `GET READY... ${countdown}`;
                } else {
                    clearInterval(countdownInterval);
                    progressDiv.textContent = 'SMILE! üì∏';
                    startPhotoCapture(photos);
                }
            }, 1000);
        }

        function startPhotoCapture(photos) {
            const progressDiv = document.querySelector('.photobox-progress');
            const photoBtn = document.querySelector('.photo-btn');
            const framesContainer = document.querySelector('.photo-frames-container');
            
            const captureInterval = setInterval(() => {
                if (currentPhotoIndex < photos.length) {
                    const frameId = `frame-${currentPhotoIndex + 1}`;
                    const frame = document.getElementById(frameId);
                    
                    if (frame) {
                        progressDiv.textContent = '‚ú® FLASH! ‚ú®';
                        
                        setTimeout(() => {
                            if (framesContainer) {
                                const frameTop = frame.offsetTop - framesContainer.offsetTop;
                                const containerHeight = framesContainer.clientHeight;
                                const frameHeight = frame.clientHeight;
                                const scrollPosition = frameTop - (containerHeight / 2) + (frameHeight / 2);
                                framesContainer.scrollTop = scrollPosition;
                            }
                        }, 200);
                        
                        setTimeout(() => {
                            frame.classList.add('filled');
                            const photo = photos[currentPhotoIndex];
                            frame.innerHTML = `
                                <img src="${photo.image}" alt="${photo.text}" class="photo-image" 
                                     onerror="this.style.display='none';" />
                                <div class="photo-overlay">
                                    <div class="photo-content">${photo.text}</div>
                                </div>
                            `;
                            
                            const displayCount = currentPhotoIndex + 1;
                            progressDiv.textContent = `CAPTURED ${displayCount}/${photos.length}`;
                            currentPhotoIndex++;
                        }, 500);
                    } else {
                        currentPhotoIndex++;
                    }
                } else {
                    clearInterval(captureInterval);
                    
                    setTimeout(() => {
                        if (framesContainer) framesContainer.scrollTop = 0;
                    }, 1000);
                    
                    setTimeout(() => {
                        progressDiv.textContent = 'üéâ PHOTO STRIP COMPLETE! üéâ';
                        photoBtn.textContent = 'CETAK LAGI';
                        photoBtn.disabled = false;
                        photoBtn.onclick = resetGallery;
                    }, 2000);
                }
            }, 2500);
        }

        function resetGallery() {
            const progressDiv = document.querySelector('.photobox-progress');
            const photoBtn = document.querySelector('.photo-btn');
            const photoDisplay = document.querySelector('.photo-display');
            
            progressDiv.textContent = 'READY TO PRINT';
            photoBtn.textContent = 'MULAI CETAK';
            photoBtn.onclick = startPhotoShow;
            
            if (photoDisplay) {
                photoDisplay.innerHTML = '<div class="photo-placeholder">Press MULAI CETAK to start photo session</div>';
            }
            
            currentPhotoIndex = 0;
        }

        // Message Typewriter
        function startTypewriter() {
            const el = document.getElementById('message-text');
            const message = `Hi,

Happy Birthday!

Hari ini aku pengen kamu ngerasain semua hal positif dan keajaiban yang cuma bisa didapetin kalo kamu ada di dunia ini. Semoga segala keinginanmu tercapai, apalagi yang kocak-kocak dan gak biasa, karena kamu tuh unik banget! Aku selalu percaya kalau kamu bisa melewati semua tantangan dengan kekuatan dan semangat yang luar biasa.

Terima kasih udah jadi bagian hidup aku yang paling berharga. Kamu bener-bener bikin hari-hari aku jadi lebih berarti dan penuh warna. Semoga di tahun yang baru ini, kamu makin bahagia, makin sukses, dan tentunya makin cantik (walaupun udah cantik banget sih!).

I love you so much! üíï`;
            
            el.innerHTML = '';
            let i = 0;
            
            if (typeInterval) clearInterval(typeInterval);
            
            typeInterval = setInterval(() => {
                if (i < message.length) {
                    el.innerHTML += message[i] === '\n' ? '<br>' : message[i];
                    i++;
                    el.scrollTop = el.scrollHeight;
                } else {
                    clearInterval(typeInterval);
                }
            }, 50);
        }

        function skipTypewriter() {
            if (typeInterval) {
                clearInterval(typeInterval);
                const el = document.getElementById('message-text');
                el.innerHTML = `Hi,<br><br>Happy Birthday!<br><br>Hari ini aku pengen kamu ngerasain semua hal positif dan keajaiban yang cuma bisa didapetin kalo kamu ada di dunia ini. Semoga segala keinginanmu tercapai, apalagi yang kocak-kocak dan gak biasa, karena kamu tuh unik banget! Aku selalu percaya kalau kamu bisa melewati semua tantangan dengan kekuatan dan semangat yang luar biasa.<br><br>Terima kasih udah jadi bagian hidup aku yang paling berharga. Kamu bener-bener bikin hari-hari aku jadi lebih berarti dan penuh warna. Semoga di tahun yang baru ini, kamu makin bahagia, makin sukses, dan tentunya makin cantik (walaupun udah cantik banget sih!).<br><br>I love you so much! üíï`;
            }
        }

        // Tetris Game
        function startTetris() {
            const canvas = document.getElementById('tetris-canvas');
            const ctx = canvas.getContext('2d');
            
            tetrisGame = {
                canvas, ctx,
                board: Array(12).fill().map(() => Array(11).fill(0)),
                piece: null,
                running: false,
                blockSize: 30
            };
            
            score = 0;
            level = 1;
            updateStats();
            drawBoard();
            
            tetrisGame.piece = createPiece();
            tetrisGame.running = true;
            gameLoop();
        }

        function createPiece() {
            const pieces = [
                {shape: [[1,1,1,1]], color: 1}, // I
                {shape: [[1,1],[1,1]], color: 2}, // O
                {shape: [[0,1,0],[1,1,1]], color: 3}, // T
                {shape: [[0,1,1],[1,1,0]], color: 4}, // S
                {shape: [[1,1,0],[0,1,1]], color: 5}, // Z
            ];
            const p = pieces[Math.floor(Math.random() * pieces.length)];
            return { shape: p.shape, x: 4, y: 0, color: p.color };
        }

        function drawBoard() {
            if (!tetrisGame) return;
            const {ctx, canvas, board, piece, blockSize} = tetrisGame;
            
            ctx.fillStyle = '#0a0a0a';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw grid
            ctx.strokeStyle = '#222';
            ctx.lineWidth = 0.5;
            for (let x = 0; x <= 11; x++) {
                ctx.beginPath();
                ctx.moveTo(x * blockSize, 0);
                ctx.lineTo(x * blockSize, 12 * blockSize);
                ctx.stroke();
            }
            for (let y = 0; y <= 12; y++) {
                ctx.beginPath();
                ctx.moveTo(0, y * blockSize);
                ctx.lineTo(11 * blockSize, y * blockSize);
                ctx.stroke();
            }
            
            // Draw placed blocks
            for (let y = 0; y < board.length; y++) {
                for (let x = 0; x < board[y].length; x++) {
                    if (board[y][x]) {
                        ctx.fillStyle = '#4a90e2';
                        ctx.fillRect(x * blockSize + 2, y * blockSize + 2, blockSize - 4, blockSize - 4);
                    }
                }
            }
            
            // Draw current piece
            if (piece) {
                ctx.fillStyle = '#e74c3c';
                piece.shape.forEach((row, dy) => {
                    row.forEach((val, dx) => {
                        if (val) {
                            const px = (piece.x + dx) * blockSize;
                            const py = (piece.y + dy) * blockSize;
                            ctx.fillRect(px + 2, py + 2, blockSize - 4, blockSize - 4);
                        }
                    });
                });
            }
        }

        function gameLoop() {
            if (!tetrisGame || !tetrisGame.running) return;
            
            if (!canMove(tetrisGame.piece, 0, 1)) {
                placePiece();
                clearLines();
                tetrisGame.piece = createPiece();
                
                if (!canMove(tetrisGame.piece, 0, 0)) {
                    gameOver();
                    return;
                }
            } else {
                tetrisGame.piece.y++;
            }
            
            drawBoard();
            setTimeout(gameLoop, 300); // Much faster fall speed - blocks drop every 300ms
        }

        function canMove(piece, dx, dy) {
            if (!piece) return false;
            
            for (let y = 0; y < piece.shape.length; y++) {
                for (let x = 0; x < piece.shape[y].length; x++) {
                    if (piece.shape[y][x]) {
                        const newX = piece.x + x + dx;
                        const newY = piece.y + y + dy;
                        
                        // Check boundaries - 11 wide, 12 tall
                        if (newX < 0 || newX > 10 || newY > 11) return false;
                        // Check collision with placed blocks only if within board
                        if (newY >= 0 && newY < 12 && newX >= 0 && newX < 11) {
                            if (tetrisGame.board[newY][newX]) return false;
                        }
                    }
                }
            }
            return true;
        }

        function movePiece(dir) {
            if (!tetrisGame || !tetrisGame.piece) return;
            
            const dx = dir === 'left' ? -1 : dir === 'right' ? 1 : 0;
            if (canMove(tetrisGame.piece, dx, 0)) {
                tetrisGame.piece.x += dx;
                drawBoard();
            }
        }

        function rotatePiece() {
            if (!tetrisGame || !tetrisGame.piece) return;
            
            const rotated = tetrisGame.piece.shape[0].map((_, i) =>
                tetrisGame.piece.shape.map(row => row[i]).reverse()
            );
            
            const temp = tetrisGame.piece.shape;
            tetrisGame.piece.shape = rotated;
            
            if (!canMove(tetrisGame.piece, 0, 0)) {
                tetrisGame.piece.shape = temp;
            }
            drawBoard();
        }

        function placePiece() {
            const {piece, board} = tetrisGame;
            piece.shape.forEach((row, dy) => {
                row.forEach((val, dx) => {
                    if (val) {
                        const y = piece.y + dy;
                        const x = piece.x + dx;
                        if (y >= 0) board[y][x] = 1;
                    }
                });
            });
        }

        function clearLines() {
            let cleared = 0;
            for (let y = tetrisGame.board.length - 1; y >= 0; y--) {
                if (tetrisGame.board[y].every(cell => cell)) {
                    tetrisGame.board.splice(y, 1);
                    tetrisGame.board.unshift(Array(11).fill(0));
                    cleared++;
                    y++;
                }
            }
            if (cleared > 0) {
                score += cleared * 100 * level;
                level = Math.floor(score / 1000) + 1;
                updateStats();
            }
        }

        function updateStats() {
            document.getElementById('score').textContent = score;
            document.getElementById('level').textContent = level;
        }

        function gameOver() {
            tetrisGame.running = false;
            document.getElementById('game-over-modal').classList.add('active');
        }

        function showFinalMessage() {
            document.getElementById('game-over-modal').classList.remove('active');
            document.getElementById('final-message-modal').classList.add('active');
        }

        function closeFinalMessage() {
            document.getElementById('final-message-modal').classList.remove('active');
            showScreen('main');
            score = 0;
            level = 1;
        }

        // Keyboard controls
        document.addEventListener('keydown', e => {
            if (currentScreen === 'tetris' && tetrisGame && tetrisGame.running) {
                if (e.key === 'ArrowLeft') movePiece('left');
                if (e.key === 'ArrowRight') movePiece('right');
                if (e.key === 'ArrowDown') movePiece('down');
                if (e.key === 'ArrowUp' || e.key === ' ') rotatePiece();
            }
        });
    </script>
</body>
</html>